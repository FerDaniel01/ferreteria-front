(function(e){function t(t){for(var r,c,o=t[0],s=t[1],i=t[2],p=0,h=[];p<o.length;p++)c=o[p],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&h.push(a[c][0]),a[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(h.length)h.shift()();return u.push.apply(u,i||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n=u[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(r=!1)}r&&(u.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},u=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var i=0;i<o.length;i++)t(o[i]);var l=s;u.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0025":function(e,t,n){},"1a21":function(e,t,n){},"4c42":function(e,t,n){"use strict";n("0025")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a={id:"app",class:"app"},u={class:"header"},c=Object(r["e"])("h1",null,"Banco UN",-1),o=Object(r["e"])("br",null,null,-1),s={class:"main-component"},i=Object(r["e"])("div",{class:"footer"},[Object(r["e"])("h2",null,"Misión TIC 2022")],-1);function l(e,t,n,l,p,h){var f=Object(r["t"])("router-view");return Object(r["p"])(),Object(r["d"])("div",a,[Object(r["e"])("div",u,[c,Object(r["e"])("nav",null,[e.is_auth?(Object(r["p"])(),Object(r["d"])("button",{key:0,onClick:t[0]||(t[0]=function(){return h.init&&h.init.apply(h,arguments)}),class:"btn btn-primary"}," Inicio ")):Object(r["c"])("",!0),e.is_auth?(Object(r["p"])(),Object(r["d"])("button",{key:1,onClick:t[1]||(t[1]=function(){return h.logOut&&h.logOut.apply(h,arguments)})},"Cerrar Sesión")):Object(r["c"])("",!0)])]),o,Object(r["e"])("div",s,[Object(r["g"])(f,{onLogIn:h.logIn},null,8,["onLogIn"])]),i])}var p,h=n("8785"),f=n("1da1"),b=(n("96cf"),n("5184")),d={name:"App",data:function(){return{is_auth:!1}},created:function(){this.updateAccessToken()},methods:{updateAccessToken:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=localStorage.getItem("refresh_token")){e.next=4;break}return this.$router.push({name:"user_auth"}),this.is_auth=!1,e.abrupt("return");case 4:return e.next=6,this.$apollo.mutate({mutation:Object(b["a"])(p||(p=Object(h["a"])(["\n            mutation ($refreshTokenRefresh: String!) {\n              refreshToken(refresh: $refreshTokenRefresh) {\n                access\n              }\n            }\n          "]))),variables:{refreshTokenRefresh:localStorage.getItem("refresh_token")}}).then((function(e){localStorage.setItem("access_token",e.data.refreshToken.access),t.is_auth=!0})).catch((function(e){alert("Su sesión expiró, vuelva a iniciar sesión."),t.$router.push({name:"user_auth"}),t.is_auth=!1}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),logIn:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return localStorage.setItem("access_token",t.access),localStorage.setItem("refresh_token",t.refresh),localStorage.setItem("user_id",t.user_id),localStorage.setItem("current_username",n),e.next=6,this.updateAccessToken();case 6:this.is_auth&&this.init();case 7:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),init:function(){this.$router.push({name:"user",params:{username:localStorage.getItem("current_username")}})},logOut:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user_id"),localStorage.removeItem("current_username"),e.next=6,this.updateAccessToken();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}};n("bf80");d.render=l;var m=d,O=n("6c02"),j={id:"User"},v=Object(r["f"])("Hola "),g=Object(r["f"])(" ¡Bienvenido!");function _(e,t,n,a,u,c){return Object(r["p"])(),Object(r["d"])("div",j,[Object(r["e"])("h2",null,[v,Object(r["e"])("span",null,Object(r["v"])(e.username)+", ",1),g])])}var y={name:"User",data:function(){return{username:"none"}},created:function(){this.username=this.$route.params.username}};n("4c42");y.render=_;var w=y,k={id:"AuthUser",class:"auth_user"},S={class:"container_auth_user"},I=Object(r["e"])("h2",null,"Log In",-1),x=Object(r["e"])("br",null,null,-1),A=Object(r["e"])("br",null,null,-1),T=Object(r["f"])(" Iniciar Sesion ");function R(e,t,n,a,u,c){var o=Object(r["t"])("v-button");return Object(r["p"])(),Object(r["d"])("div",k,[Object(r["e"])("div",S,[I,Object(r["e"])("form",{onSubmit:t[2]||(t[2]=Object(r["B"])((function(){return c.processAuthUser&&c.processAuthUser.apply(c,arguments)}),["prevent"]))},[Object(r["A"])(Object(r["e"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.user_in.username=t}),placeholder:"Username"},null,512),[[r["x"],e.user_in.username]]),x,Object(r["A"])(Object(r["e"])("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.user_in.password=t}),placeholder:"Password"},null,512),[[r["x"],e.user_in.password]]),A,Object(r["g"])(o,{type:"submit",class:"btn btn-outline-primary"},{default:Object(r["z"])((function(){return[T]})),_:1})],32)])])}n("4d90"),n("d3b7"),n("25f0");var U,$=n("1232"),C={name:"UserAuth",data:function(){return{user_in:{username:"",password:""}}},methods:{processAuthUser:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$apollo.mutate({mutation:Object(b["a"])(U||(U=Object(h["a"])(["\n            mutation ($authenticateCredentials: CredentialsInput!) {\n              authenticate(credentials: $authenticateCredentials) {\n                refresh\n                access\n              }\n            }\n          "]))),variables:{authenticateCredentials:this.user_in}}).then((function(e){var n=e.data.authenticate;n.user_id=Object($["a"])(n.access).user_id.toString().padStart(3,"0"),t.$emit("log-in",n,t.user_in.username)})).catch((function(e){alert("El usuario y/o contraseña son incorrectos")}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}};n("5903");C.render=R;var P=C,M=[{path:"/",name:"root",component:m},{path:"/user/auth",name:"user_auth",component:P},{path:"/user/:username",name:"user",component:w}],B=Object(O["a"])({history:Object(O["b"])("/"),routes:M}),L=B,J=n("a012"),V=n("365c"),z=n("957f"),E=n("4cc9"),H=Object(J["a"])({uri:"https://ferreteria-api.herokuapp.com/"}),N=new V["a"]({link:H,cache:new z["a"]}),q=new E["a"]({defaultClient:N});Object(r["b"])(m).use(L).use(q).mount("#app")},5903:function(e,t,n){"use strict";n("6bc3")},"6bc3":function(e,t,n){},bf80:function(e,t,n){"use strict";n("1a21")}});
//# sourceMappingURL=app.c3a05e23.js.map